(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{63:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"使えそうなapiの紹介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使えそうなapiの紹介","aria-hidden":"true"}},[t._v("#")]),t._v(" 使えそうなAPIの紹介")]),e("p",[t._v("簡単に。")]),e("h3",{attrs:{id:"情報を保存する"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#情報を保存する","aria-hidden":"true"}},[t._v("#")]),t._v(" 情報を保存する")]),e("p",[e("code",[t._v("storage.local.get()")]),t._v(" と "),e("code",[t._v("storage.local.set()")]),t._v(" を。")]),e("p",[e("code",[t._v('"permissions"')]),t._v(" の設定をお忘れなく。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/storage/local",target:"_blank",rel:"noopener noreferrer"}},[t._v("storage.local - Mozilla | MDN")])]),e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/storage/StorageArea/get",target:"_blank",rel:"noopener noreferrer"}},[t._v("StorageArea.get() - Mozilla | MDN")])]),e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/storage/StorageArea/set",target:"_blank",rel:"noopener noreferrer"}},[t._v("StorageArea.set() - Mozilla | MDN")])])]),e("p",[t._v("3種類あるけど、とりあえず "),e("code",[t._v("storage.local")]),t._v(" で良さそう。")]),e("ul",[e("li",[e("code",[t._v("storage.local")]),t._v(" - 端末単位に保存される情報。何も考えずに使える")]),e("li",[e("code",[t._v("storage.sync")]),t._v(" - ログインして端末間で共有される情報っぽい。Firefoxはひと手間ある")]),e("li",[e("code",[t._v("storage.managed")]),t._v(" - 実質 "),e("code",[t._v("manifest.json")]),t._v(" で定義する情報を読む専用っぽい。別途 "),e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/getManifest",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("runtime.getManifest()")])]),t._v(" もある。")])]),e("p",[t._v("あと "),e("code",[t._v("await")]),t._v(" 使う場合はその外側が "),e("code",[t._v("async")]),t._v(" になっている必要があります。")]),e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" message "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("querySelector")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'#message'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// 最初に読み込み")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" browser"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("storage"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("local"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token keyword"}},[t._v("get")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{attrs:{class:"token string"}},[t._v("'message'")]),e("span",{attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  message"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'2'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  message"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" result"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message "),e("span",{attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'Hello World!'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// 変更あれば書き込み")]),t._v("\n  message"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'input'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    browser"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("storage"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("local"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token keyword"}},[t._v("set")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" message"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" message"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),e("h3",{attrs:{id:"見ているページに挿入する"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#見ているページに挿入する","aria-hidden":"true"}},[t._v("#")]),t._v(" 見ているページに挿入する")]),e("p",[t._v("特定のページ、あるいは全ページにJSファイルやCSSファイルを挿入する場合は、 "),e("code",[t._v("manifest.json")]),t._v(" の "),e("code",[t._v("content_scripts")]),t._v(" を使う。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/ja/Add-ons/WebExtensions/manifest.json/content_scripts",target:"_blank",rel:"noopener noreferrer"}},[t._v("content_scripts - Mozilla | MDN")])])]),e("p",[t._v("スクリプトからコードを生成して実行する場合、あるいはJSファイルやCSSファイルを挿入する場合は "),e("code",[t._v("tabs.executeScript()")]),t._v(" や "),e("code",[t._v("tabs.insertCSS()")]),t._v(" を使う。いずれも "),e("code",[t._v("manifest.json")]),t._v(" の "),e("code",[t._v('"permissions"')]),t._v(" で "),e("code",[t._v('"activeTab"')]),t._v(" を許可する。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/tabs/executeScript",target:"_blank",rel:"noopener noreferrer"}},[t._v("tabs.executeScript() - Mozilla | MDN")])]),e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/tabs/insertCSS",target:"_blank",rel:"noopener noreferrer"}},[t._v("tabs.insertCSS() - Mozilla | MDN")])]),e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/ja/Add-ons/WebExtensions/manifest.json/permissions",target:"_blank",rel:"noopener noreferrer"}},[t._v("permissions - Mozilla | MDN")])])]),e("p",[t._v("挿入したファイルからブラウザー拡張が持つファイルにアクセスする場合（画像を表示するとか）、 "),e("code",[t._v("manifest.json")]),t._v(" で "),e("code",[t._v("web_accessible_resources")]),t._v(" を使ってアクセス権の設定が必要。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/ja/Add-ons/WebExtensions/manifest.json/web_accessible_resources",target:"_blank",rel:"noopener noreferrer"}},[t._v("web_accessible_resources - Mozilla | MDN")])])]),e("h3",{attrs:{id:"設定画面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#設定画面","aria-hidden":"true"}},[t._v("#")]),t._v(" 設定画面")]),e("p",[e("code",[t._v("manifest.json")]),t._v(" の "),e("code",[t._v("options_ui")]),t._v(" を使う。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/ja/Add-ons/WebExtensions/manifest.json/options_ui",target:"_blank",rel:"noopener noreferrer"}},[t._v("options_ui - Mozilla | MDN")])])]),e("p",[t._v("ちなみに "),e("code",[t._v("options_page")]),t._v(" というのもある。")]),e("h3",{attrs:{id:"拡張専用の任意ページ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#拡張専用の任意ページ","aria-hidden":"true"}},[t._v("#")]),t._v(" 拡張専用の任意ページ")]),e("p",[e("code",[t._v("tabs.create()")]),t._v(" で、 "),e("code",[t._v("url")]),t._v(" の指定を "),e("code",[t._v("/")]),t._v(" から始めて任意のHTMLファイル等を指定する。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/tabs/create",target:"_blank",rel:"noopener noreferrer"}},[t._v("tabs.create() - Mozilla | MDN")])])]),e("h3",{attrs:{id:"manifest-json-の情報を得る"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#manifest-json-の情報を得る","aria-hidden":"true"}},[t._v("#")]),e("code",[t._v("manifest.json")]),t._v(" の情報を得る")]),e("p",[e("code",[t._v("runtime.getManifest()")]),t._v(" を使う。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/getManifest",target:"_blank",rel:"noopener noreferrer"}},[t._v("runtime.getManifest() - Mozilla | MDN")])])]),e("h3",{attrs:{id:"スクリプト間でやりとりする"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#スクリプト間でやりとりする","aria-hidden":"true"}},[t._v("#")]),t._v(" スクリプト間でやりとりする")]),e("p",[t._v("本文でもやったけど、 "),e("code",[t._v("runtime.sendMessage()")]),t._v(" と "),e("code",[t._v("runtime.onMessage")]),t._v(" でやりとりする。バックグラウンドからその他へ、あるいはその他からバックグラウンドへのメッセージ送受信になるっぽい。")]),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/sendMessage",target:"_blank",rel:"noopener noreferrer"}},[t._v("runtime.sendMessage() - Mozilla | MDN")])]),e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/runtime/onMessage",target:"_blank",rel:"noopener noreferrer"}},[t._v("runtime.onMessage - Mozilla | MDN")])])]),e("p",[t._v("コンテンツスクリプトだと受信できない？")]),e("h2",{attrs:{id:"おしまい"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#おしまい","aria-hidden":"true"}},[t._v("#")]),t._v(" おしまい")]),e("p",[t._v("っていう話をVuePressを使ってやってみたんだけど、どこで公開しようとか考えてる間に先に内容をある程度出しておこうと思ってここに置いておきます。")]),e("p",[t._v("今後とも何卒宜しくお願い致します。")])])}],!1,null,null,null);s.default=n.exports}}]);